(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();const h="kanban_tasks";class c{static saveTasks(e){try{const t=JSON.stringify(e);localStorage.setItem(h,t)}catch(t){console.error("Error saving tasks to localStorage:",t)}}static loadTasks(){try{const e=localStorage.getItem(h);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading tasks from localStorage:",e),[]}}static clearTasks(){try{localStorage.removeItem(h)}catch(e){console.error("Error clearing tasks from localStorage:",e)}}static isAvailable(){try{const e="localStorage_test";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return console.warn("localStorage is not available:",e),!1}}}window.KanbanStorage=c;class n{static createElement(e,t=[],r={}){const s=document.createElement(e);return typeof t=="string"?s.classList.add(t):Array.isArray(t)&&s.classList.add(...t),Object.entries(r).forEach(([o,a])=>{s.setAttribute(o,a)}),s}static querySelector(e,t=document){try{return t.querySelector(e)}catch(r){return console.error(`Error selecting element with selector "${e}":`,r),null}}static querySelectorAll(e,t=document){try{return t.querySelectorAll(e)}catch(r){return console.error(`Error selecting elements with selector "${e}":`,r),[]}}static addEventListener(e,t,r,s=!1){if(!e||typeof r!="function"){console.error("Invalid element or handler provided to addEventListener");return}try{e.addEventListener(t,r,s)}catch(o){console.error(`Error adding event listener for "${t}":`,o)}}static removeEventListener(e,t,r){if(!e||typeof r!="function"){console.error("Invalid element or handler provided to removeEventListener");return}try{e.removeEventListener(t,r)}catch(s){console.error(`Error removing event listener for "${t}":`,s)}}static sanitizeHTML(e){if(typeof e!="string")return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}static truncateText(e,t,r="..."){return typeof e!="string"||e.length<=t?e:e.substring(0,t-r.length)+r}static generateUniqueId(e="id"){return`${e}_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}static toggleVisibility(e,t,r=300){e&&(t?(e.style.display="block",e.style.opacity="0",e.style.transition=`opacity ${r}ms ease`,e.offsetHeight,e.style.opacity="1"):(e.style.transition=`opacity ${r}ms ease`,e.style.opacity="0",setTimeout(()=>{e.style.opacity==="0"&&(e.style.display="none")},r)))}}window.KanbanDOMUtils=n;class g{constructor(e){this.taskManager=e,this.draggedElement=null,this.placeholder=null,this.init()}init(){this.setupGlobalEventListeners()}setupGlobalEventListeners(){n.addEventListener(document,"dragover",e=>{e.preventDefault(),this.handleDragOver(e)}),n.addEventListener(document,"drop",e=>{e.preventDefault(),this.handleDrop(e)}),n.addEventListener(document,"dragend",e=>{this.handleDragEnd(e)})}makeTaskDraggable(e,t){e.setAttribute("draggable","true"),e.dataset.taskId=t.id,n.addEventListener(e,"dragstart",r=>{this.handleDragStart(r,e,t)}),n.addEventListener(e,"dragenter",r=>{r.target!==this.draggedElement&&r.target.classList.add("drag-over")}),n.addEventListener(e,"dragleave",r=>{r.target.classList.remove("drag-over")})}handleDragStart(e,t,r){this.draggedElement=t,t.classList.add("dragging"),e.dataTransfer.setData("text/plain",r.id),e.dataTransfer.effectAllowed="move",this.createPlaceholder(),console.log("Drag started for task:",r.id)}handleDragOver(e){if(!this.draggedElement)return;const t=e.target.closest(".column");t&&(t.classList.add("drag-over"),n.querySelectorAll(".column").forEach(r=>{r!==t&&r.classList.remove("drag-over")}),this.handleInsertionPoint(e,t))}handleInsertionPoint(e,t){const r=t.querySelector(".column-content");if(!r)return;const s=Array.from(r.querySelectorAll(".task-card:not(.dragging)")),o=e.clientY;let a=null;for(let i=0;i<s.length;i++){const l=s[i],u=l.getBoundingClientRect(),k=u.top+u.height/2;if(o>k)a=l;else break}this.updatePlaceholderPosition(r,a)}createPlaceholder(){this.placeholder&&this.placeholder.remove(),this.placeholder=n.createElement("div","task-card-placeholder",{style:"height: 80px; border: 2px dashed #3B82F6; background: rgba(59, 130, 246, 0.1); margin-bottom: 16px; border-radius: 8px;"})}updatePlaceholderPosition(e,t){this.placeholder&&(this.placeholder.parentNode&&this.placeholder.remove(),t?t.insertAdjacentElement("afterend",this.placeholder):e.insertBefore(this.placeholder,e.firstChild))}handleDrop(e){if(!this.draggedElement)return;const t=e.target.closest(".column");if(!t)return;const r=t.dataset.status,s=e.dataTransfer.getData("text/plain");if(console.log(`Dropping task ${s} into ${r} column`),this.taskManager){this.taskManager.updateTaskStatus(s,r);const o=this.getInsertionIndex(t);this.taskManager.moveTaskToPosition(s,r,o)}this.cleanupDragState()}getInsertionIndex(e){if(!this.placeholder||!this.placeholder.parentNode)return-1;const t=e.querySelector(".column-content");return Array.from(t.children).indexOf(this.placeholder)}handleDragEnd(e){this.cleanupDragState()}cleanupDragState(){n.querySelectorAll(".dragging").forEach(e=>{e.classList.remove("dragging")}),n.querySelectorAll(".drag-over").forEach(e=>{e.classList.remove("drag-over")}),this.placeholder&&this.placeholder.parentNode&&this.placeholder.remove(),this.draggedElement=null,this.placeholder=null}}window.KanbanDragDrop=g;class p{constructor(){this.tasks=[],this.dragDrop=null,this.init()}init(){this.loadTasks(),this.renderAllTasks(),this.updateTaskCounts()}setDragDrop(e){this.dragDrop=e}loadTasks(){this.tasks=c.loadTasks(),console.log("Loaded tasks:",this.tasks)}saveTasks(){c.saveTasks(this.tasks),console.log("Tasks saved:",this.tasks)}createTask(e,t){if(!e.trim())throw new Error("Task title is required");const r={id:n.generateUniqueId("task"),title:e.trim(),description:t.trim(),status:"todo",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return this.tasks.push(r),this.saveTasks(),this.renderTask(r),this.updateTaskCounts(),console.log("Task created:",r),r}updateTaskStatus(e,t){const r=this.tasks.find(o=>o.id===e);if(!r){console.error("Task not found:",e);return}const s=r.status;r.status=t,r.updatedAt=new Date().toISOString(),this.saveTasks(),this.updateTaskCounts(),console.log(`Task ${e} moved from ${s} to ${t}`)}moveTaskToPosition(e,t,r){const s=this.tasks.find(l=>l.id===e);if(!s)return;const o=this.tasks.indexOf(s);this.tasks.splice(o,1);const a=this.tasks.filter(l=>l.status===t),i=this.tasks.filter(l=>l.status!==t);r>=0&&r<=a.length?a.splice(r,0,s):a.push(s),this.tasks=[...i,...a],this.saveTasks(),this.renderAllTasks()}deleteTask(e){const t=this.tasks.findIndex(s=>s.id===e);if(t===-1){console.error("Task not found for deletion:",e);return}this.tasks.splice(t,1),this.saveTasks();const r=n.querySelector(`[data-task-id="${e}"]`);r&&r.remove(),this.updateTaskCounts(),console.log("Task deleted:",e)}renderTask(e){const t=this.createTaskElement(e),r=n.querySelector(`#${e.status}Column`);return r&&r.appendChild(t),t}createTaskElement(e){const t=n.createElement("div","task-card",{"data-task-id":e.id}),r=n.createElement("h3");r.textContent=n.truncateText(e.title,60);const s=n.createElement("p");s.textContent=e.description||"No description";const o=n.createElement("div","task-meta"),a=n.createElement("span","task-id");a.textContent=`#${e.id.split("_")[1]||e.id.substring(0,8)}`;const i=n.createElement("button","delete-btn");return i.textContent="Delete",i.title="Delete this task",n.addEventListener(i,"click",l=>{l.stopPropagation(),this.handleDeleteTask(e.id)}),o.appendChild(a),o.appendChild(i),t.appendChild(r),t.appendChild(s),t.appendChild(o),this.dragDrop&&this.dragDrop.makeTaskDraggable(t,e),t}handleDeleteTask(e){const t=this.tasks.find(s=>s.id===e);if(!t)return;confirm(`Are you sure you want to delete "${t.title}"?`)&&this.deleteTask(e)}renderAllTasks(){["todoColumn","inprogressColumn","doneColumn"].forEach(t=>{const r=n.querySelector(`#${t}`);r&&(r.innerHTML="")}),this.tasks.forEach(t=>{this.renderTask(t)}),this.addEmptyStateMessages()}addEmptyStateMessages(){Object.entries({todoColumn:"todo",inprogressColumn:"inprogress",doneColumn:"done"}).forEach(([t,r])=>{const s=n.querySelector(`#${t}`);if(!s)return;if(!this.tasks.some(a=>a.status===r)){const a=n.createElement("div","empty-state");a.textContent="No tasks yet. Drag tasks here or create new ones.",s.appendChild(a)}})}updateTaskCounts(){const e={todo:this.tasks.filter(o=>o.status==="todo").length,inprogress:this.tasks.filter(o=>o.status==="inprogress").length,done:this.tasks.filter(o=>o.status==="done").length},t=n.querySelector("#todoCount"),r=n.querySelector("#inprogressCount"),s=n.querySelector("#doneCount");t&&(t.textContent=e.todo),r&&(r.textContent=e.inprogress),s&&(s.textContent=e.done)}getTasksByStatus(e){return this.tasks.filter(t=>t.status===e)}getTotalTaskCount(){return this.tasks.length}searchTasks(e){if(!e.trim())return this.tasks;const t=e.toLowerCase();return this.tasks.filter(r=>r.title.toLowerCase().includes(t)||r.description.toLowerCase().includes(t))}}window.KanbanTaskManager=p;class m{constructor(e){this.taskManager=e,this.init()}init(){this.setupFormHandlers(),this.setupKeyboardHandlers(),this.setupWindowHandlers()}setupFormHandlers(){const e=n.querySelector("#taskForm"),t=n.querySelector("#taskTitle"),r=n.querySelector("#taskDescription");if(!e||!t||!r){console.error("Required form elements not found");return}n.addEventListener(e,"submit",s=>{s.preventDefault(),this.handleFormSubmission(t,r)}),n.addEventListener(t,"input",s=>{this.handleTitleValidation(s.target)}),n.addEventListener(r,"input",s=>{this.handleTextareaResize(s.target)}),this.setupCharacterCount(t,100),this.setupCharacterCount(r,500)}handleFormSubmission(e,t){const r=e.value.trim(),s=t.value.trim();if(!r){this.showFieldError(e,"Task title is required"),e.focus();return}if(r.length>100){this.showFieldError(e,"Task title must be 100 characters or less"),e.focus();return}if(s.length>500){this.showFieldError(t,"Description must be 500 characters or less"),t.focus();return}try{const o=this.taskManager.createTask(r,s);this.clearForm(e,t),this.clearFieldErrors(),this.showSuccessMessage(`Task "${o.title}" created successfully!`),e.focus()}catch(o){console.error("Error creating task:",o),this.showFieldError(e,o.message||"Failed to create task")}}handleTitleValidation(e){const t=e.value;this.clearFieldError(e),t.length>100&&this.showFieldError(e,"Title must be 100 characters or less")}handleTextareaResize(e){e.style.height="auto";const t=60,r=200,s=e.scrollHeight,o=Math.min(Math.max(s,t),r);e.style.height=o+"px",s>r?e.style.overflowY="auto":e.style.overflowY="hidden"}setupCharacterCount(e,t){const r=n.createElement("div","character-count",{style:"font-size: 0.75rem; color: #64748B; text-align: right; margin-top: 4px;"});e.parentNode.appendChild(r);const s=()=>{const o=e.value.length,a=t-o;r.textContent=`${o}/${t}`,a<20?r.style.color="#EF4444":a<50?r.style.color="#F59E0B":r.style.color="#64748B"};s(),n.addEventListener(e,"input",s)}setupKeyboardHandlers(){n.addEventListener(document,"keydown",e=>{if((e.ctrlKey||e.metaKey)&&e.key==="Enter"){const t=n.querySelector("#taskTitle");(document.activeElement===t||document.activeElement===n.querySelector("#taskDescription"))&&(e.preventDefault(),n.querySelector("#taskForm").dispatchEvent(new Event("submit")))}e.key==="Escape"&&(this.clearForm(),this.clearFieldErrors())})}setupWindowHandlers(){n.addEventListener(document,"visibilitychange",()=>{document.hidden||(this.taskManager.loadTasks(),this.taskManager.renderAllTasks(),this.taskManager.updateTaskCounts())}),n.addEventListener(window,"beforeunload",()=>{this.taskManager.saveTasks()});let e;n.addEventListener(window,"resize",()=>{clearTimeout(e),e=setTimeout(()=>{this.handleWindowResize()},250)})}handleWindowResize(){console.log("Window resized, updating layout...")}clearForm(e,t){const r=e||n.querySelector("#taskTitle"),s=t||n.querySelector("#taskDescription");r&&(r.value="",r.style.height="auto"),s&&(s.value="",s.style.height="auto")}showFieldError(e,t){this.clearFieldError(e),e.classList.add("error"),e.style.borderColor="#EF4444";const r=n.createElement("div","field-error",{style:"color: #EF4444; font-size: 0.75rem; margin-top: 4px;"});r.textContent=t,e.parentNode.appendChild(r)}clearFieldError(e){e.classList.remove("error"),e.style.borderColor="";const t=e.parentNode.querySelector(".field-error");t&&t.remove()}clearFieldErrors(){n.querySelectorAll(".error").forEach(t=>this.clearFieldError(t))}showSuccessMessage(e){const t=n.createElement("div","success-notification",{style:`
        position: fixed;
        top: 20px;
        right: 20px;
        background: #10B981;
        color: white;
        padding: 16px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        transform: translateX(100%);
        transition: transform 0.3s ease;
      `});t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.style.transform="translateX(0)"},100),setTimeout(()=>{t.style.transform="translateX(100%)",setTimeout(()=>{t.parentNode&&t.remove()},300)},3e3)}}window.KanbanEventHandlers=m;class y{constructor(){this.taskManager=null,this.dragDrop=null,this.eventHandlers=null,this.isInitialized=!1}async init(){try{console.log("Initializing Kanban Board Application..."),c.isAvailable()||this.showStorageWarning(),await this.waitForDOM(),this.initializeTaskManager(),this.initializeDragDrop(),this.initializeEventHandlers(),this.connectModules(),this.setupErrorHandling(),this.setupPerformanceMonitoring(),this.isInitialized=!0,console.log("Kanban Board Application initialized successfully!"),this.dispatchAppReady()}catch(e){console.error("Failed to initialize Kanban Board Application:",e),this.handleInitializationError(e)}}waitForDOM(){return new Promise(e=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()})}initializeTaskManager(){console.log("Initializing Task Manager..."),this.taskManager=new p}initializeDragDrop(){console.log("Initializing Drag and Drop..."),this.dragDrop=new g(this.taskManager)}initializeEventHandlers(){console.log("Initializing Event Handlers..."),this.eventHandlers=new m(this.taskManager)}connectModules(){this.taskManager.setDragDrop(this.dragDrop),console.log("Modules connected successfully")}setupErrorHandling(){window.addEventListener("error",e=>{console.error("Uncaught error:",e.error),this.handleRuntimeError(e.error)}),window.addEventListener("unhandledrejection",e=>{console.error("Unhandled promise rejection:",e.reason),this.handleRuntimeError(e.reason)})}setupPerformanceMonitoring(){"performance"in window&&"mark"in window.performance&&(window.performance.mark("kanban-app-initialized"),window.addEventListener("load",()=>{const e=window.performance.getEntriesByType("navigation")[0];console.log(`App load time: ${e.loadEventEnd-e.fetchStart}ms`)}))}dispatchAppReady(){const e=new CustomEvent("kanbanAppReady",{detail:{taskManager:this.taskManager,dragDrop:this.dragDrop,eventHandlers:this.eventHandlers}});document.dispatchEvent(e)}handleInitializationError(e){const t=n.createElement("div","error-container",{style:`
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        color: white;
        font-family: system-ui;
      `}),r=n.createElement("div","error-message",{style:`
        background: #EF4444;
        padding: 2rem;
        border-radius: 8px;
        max-width: 500px;
        text-align: center;
      `});r.innerHTML=`
      <h2>Application Failed to Load</h2>
      <p>We're sorry, but there was an error loading the Kanban Board application.</p>
      <p><strong>Error:</strong> ${e.message}</p>
      <button onclick="window.location.reload()" 
              style="background: white; color: #EF4444; border: none; padding: 8px 16px; 
                     border-radius: 4px; margin-top: 1rem; cursor: pointer;">
        Reload Page
      </button>
    `,t.appendChild(r),document.body.appendChild(t)}handleRuntimeError(e){if(console.error("Runtime error in Kanban App:",e),this.eventHandlers&&this.eventHandlers.showSuccessMessage){const t=n.createElement("div","error-notification",{style:`
          position: fixed;
          top: 20px;
          right: 20px;
          background: #EF4444;
          color: white;
          padding: 16px 20px;
          border-radius: 8px;
          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
          z-index: 1000;
          max-width: 300px;
        `});t.innerHTML=`
        <strong>Error:</strong> Something went wrong.<br>
        <small>${e.message||"Unknown error occurred"}</small>
      `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.remove()},5e3)}}showStorageWarning(){console.warn("localStorage is not available. Tasks will not persist between sessions.");const e=n.createElement("div","storage-warning",{style:`
        background: #F59E0B;
        color: white;
        padding: 1rem;
        text-align: center;
        margin-bottom: 1rem;
        border-radius: 8px;
      `});e.innerHTML=`
      <strong>Warning:</strong> Local storage is not available. 
      Your tasks will not be saved between browser sessions.
    `;const t=n.querySelector(".container");t&&t.insertBefore(e,t.firstChild)}getStatus(){return{initialized:this.isInitialized,taskCount:this.taskManager?this.taskManager.getTotalTaskCount():0,storageAvailable:c.isAvailable(),modules:{taskManager:!!this.taskManager,dragDrop:!!this.dragDrop,eventHandlers:!!this.eventHandlers}}}destroy(){console.log("Destroying Kanban Application..."),this.dragDrop&&typeof this.dragDrop.destroy=="function"&&this.dragDrop.destroy(),this.taskManager=null,this.dragDrop=null,this.eventHandlers=null,this.isInitialized=!1,console.log("Kanban Application destroyed")}}const f=new y;f.init().catch(d=>{console.error("Failed to start Kanban application:",d)});window.KanbanApp=f;
